<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Monthly Calendar</title>
    <style>
        /* Your existing styles */
    </style>
</head>
<body>
    <div class="calendar">
        <div class="header" id="currentMonth"></div>
        <div class="days" id="calendarDays"></div>
    </div>

    <div id="eventModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Add Event</h2>
            <select id="personSelect">
                <option value="Cody" data-color="#FF5733">Cody</option>
                <option value="Moses" data-color="#33FF57">Moses</option>
                <option value="Halle" data-color="#3357FF">Halle</option>
                <option value="Nathan" data-color="#F1C40F">Nathan</option>
                <option value="Ahmad" data-color="#9B59B6">Ahmad</option>
                <option value="Luke" data-color="#34495E">Luke</option>
            </select>
            <input type="text" id="eventTime" placeholder="Available Time">
            <button onclick="addEvent()">Add</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const calendar = document.getElementById('calendarDays');
        const monthDisplay = document.getElementById('currentMonth');
        const modal = document.getElementById('eventModal');
        const closeBtn = document.getElementsByClassName('close')[0];
        let currentDate = new Date();
        let selectedDay = null;
        let events = {};

        function generateCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            monthDisplay.textContent = currentDate.toLocaleString('default', { month: 'long', year: 'numeric' });
            calendar.innerHTML = '';

            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                calendar.appendChild(emptyDay);
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.classList.add('day');
                dayElement.innerHTML = `<span class="day-number">${day}</span>`;

                const dateString = `${year}-${month + 1}-${day}`;
                if (events[dateString]) {
                    const colors = events[dateString].map(event => `<span style="background-color:${event.color}; border-radius:50%; display:inline-block; width:10px; height:10px; margin:2px;"></span>`).join('');
                    dayElement.innerHTML += colors;
                }

                dayElement.addEventListener('click', () => openModal(day));
                calendar.appendChild(dayElement);
            }
        }

        function openModal(day) {
            selectedDay = day;
            modal.style.display = 'block';
        }

        function addEvent() {
            const eventName = document.getElementById('personSelect').value;
            const eventColor = document.querySelector(`#personSelect option[value="${eventName}"]`).getAttribute('data-color');
            const eventTime = document.getElementById('eventTime').value;

            if (eventName && eventTime) {
                const dateString = `${currentDate.getFullYear()}-${currentDate.getMonth() + 1}-${selectedDay}`;
                if (!events[dateString]) {
                    events[dateString] = [];
                }
                events[dateString].push({ name: eventName, time: eventTime, color: eventColor });
                saveEvents(); // Save to Realtime Database
                generateCalendar();
                modal.style.display = 'none';
            }
        }

        function saveEvents() {
            db.ref('events/calendar').set(events);
        }

        function loadEvents() {
            db.ref('events/calendar').once('value').then((snapshot) => {
                if (snapshot.exists()) {
                    events = snapshot.val();
                    generateCalendar();
                }
            });
        }

        closeBtn.onclick = () => modal.style.display = 'none';
        window.onclick = (event) => {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        window.onload = () => {
            loadEvents();
            generateCalendar();
        };
    </script>
</body>
</html>
